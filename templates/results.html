<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Scan Results</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Scan Results</h1>
        </header>
        <main>
            <ul>
                <li><strong>Status:</strong> {{ results['data']['attributes']['last_analysis_stats']['status'] }}</li>
                <li><strong>Malicious:</strong> {{ results['data']['attributes']['last_analysis_stats']['malicious'] }}</li>
                <li><strong>Suspicious:</strong> {{ results['data']['attributes']['last_analysis_stats']['suspicious'] }}</li>
                <li><strong>Undetected:</strong> {{ results['data']['attributes']['last_analysis_stats']['undetected'] }}</li>
            </ul>

            <h2>Detailed Analysis</h2>
            <ul>
                {% for engine, analysis in results['data']['attributes']['last_analysis_results'].items() %}
                    <li class="expandable">
                        <strong>{{ engine }}:</strong> {{ analysis['category'] }} - {{ analysis['result'] }}
                        <div class="details">
                            <p>Engine version: {{ analysis['engine_version'] }}</p>
                            <p>Method: {{ analysis['method'] }}</p>
                            <p>Engine update: {{ analysis['engine_update'] }}</p>
                        </div>
                    </li>
                {% endfor %}
            </ul>

            <canvas id="resultChart" width="400" height="200"></canvas>

            <a class="button" href="{{ url_for('main.index') }}">Back to Home</a>
        </main>
    </div>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
